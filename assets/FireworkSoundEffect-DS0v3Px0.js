import{c as e}from"./utils-vendor-DwIcHP6x.js";import{d as t,a7 as o,D as n,J as a,c as i,v as r}from"./vue-vendor-Bt65BSdi.js";import{_ as s}from"./_plugin-vue_export-helper-BCo6x5W8.js";const c={class:"firework-sound-effect"},l=s(t({__name:"FireworkSoundEffect",props:{triggerFirework:{type:Boolean,default:!1},triggerSound:{type:Boolean,default:!1},isCorrect:{type:Boolean,default:!0},soundVolume:{default:.5}},emits:["effect-complete"],setup(t,{expose:s,emit:l}){const u=t,d=l;o(u);let f=null;const p=()=>(f&&"closed"!==f.state||(f=new(window.AudioContext||window.webkitAudioContext)),f),m=()=>{u.triggerFirework&&(u.isCorrect?(e({particleCount:100,spread:70,origin:{y:.6},colors:["#00ff00","#32cd32","#7cfc00","#adff2f","#9aff9a"]}),setTimeout(()=>{e({particleCount:50,angle:60,spread:55,origin:{x:0,y:.8},colors:["#ffd700","#ffff00","#ffffe0","#fffacd"]})},200),setTimeout(()=>{e({particleCount:50,angle:120,spread:55,origin:{x:1,y:.8},colors:["#ff69b4","#ff1493","#ffb6c1","#ffc0cb"]})},400)):e({particleCount:30,spread:45,origin:{y:.7},colors:["#ff4444","#ff6666","#ff8888","#ffaaaa"],gravity:1.2,scalar:.8}))},g=()=>{if(u.triggerSound)try{u.isCorrect?(()=>{try{const e=p();"suspended"===e.state&&e.resume();const t=(t,o,n)=>{const a=e.createOscillator(),i=e.createGain();a.connect(i),i.connect(e.destination),a.frequency.setValueAtTime(t,o),a.type="sine",i.gain.setValueAtTime(0,o),i.gain.linearRampToValueAtTime(.4*u.soundVolume,o+.02),i.gain.exponentialRampToValueAtTime(.001,o+n),a.start(o),a.stop(o+n),a.onended=()=>{a.disconnect(),i.disconnect()}},o=e.currentTime;t(523.25,o,.5),t(659.25,o+.15,.5),t(783.99,o+.3,.6)}catch(e){console.warn("Web Audio API not supported:",e)}})():(()=>{try{const e=p();"suspended"===e.state&&e.resume();const t=e.createOscillator(),o=e.createGain();t.connect(o),o.connect(e.destination);const n=e.currentTime;t.frequency.setValueAtTime(400,n),t.frequency.exponentialRampToValueAtTime(180,n+.8),t.type="sawtooth",o.gain.setValueAtTime(0,n),o.gain.linearRampToValueAtTime(.5*u.soundVolume,n+.02),o.gain.exponentialRampToValueAtTime(.001,n+.8),t.start(n),t.stop(n+.8),t.onended=()=>{t.disconnect(),o.disconnect()}}catch(e){console.warn("Web Audio API not supported:",e)}})()}catch(e){console.warn("Sound playback error:",e),T(u.isCorrect)}},T=e=>{try{const t=p();"suspended"===t.state&&t.resume();const o=t.currentTime;if(e){[523,659,784].forEach((e,n)=>{const a=t.createOscillator(),i=t.createGain();a.connect(i),i.connect(t.destination);const r=o+.15*n;a.frequency.setValueAtTime(e,r),a.type="sine",i.gain.setValueAtTime(0,r),i.gain.linearRampToValueAtTime(.4*u.soundVolume,r+.02),i.gain.exponentialRampToValueAtTime(.001,r+.4),a.start(r),a.stop(r+.4),a.onended=()=>{a.disconnect(),i.disconnect()}})}else{const e=t.createOscillator(),n=t.createGain();e.connect(n),n.connect(t.destination),e.frequency.setValueAtTime(400,o),e.frequency.exponentialRampToValueAtTime(200,o+.6),e.type="sawtooth",n.gain.setValueAtTime(0,o),n.gain.linearRampToValueAtTime(.5*u.soundVolume,o+.02),n.gain.exponentialRampToValueAtTime(.001,o+.6),e.start(o),e.stop(o+.6),e.onended=()=>{e.disconnect(),n.disconnect()}}}catch(t){console.warn("Web Audio API fallback failed:",t)}},A=()=>{(u.triggerFirework||u.triggerSound)&&(m(),g(),setTimeout(()=>{d("effect-complete")},1e3))},{triggerFirework:y,triggerSound:V,isCorrect:w}=o(u);return n([y,V],([e,t])=>{(e||t)&&A()},{immediate:!1}),a(()=>{f&&"closed"!==f.state&&setTimeout(()=>{f&&"closed"!==f.state&&(f.close(),f=null)},1e3)}),s({triggerEffects:A,triggerFireworkEffect:m,playSoundEffect:g}),(e,t)=>(r(),i("div",c))}}),[["__scopeId","data-v-146028e4"]]);export{l as default};
