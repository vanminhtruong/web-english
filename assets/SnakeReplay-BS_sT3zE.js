import{d as a,C as e,a4 as t,A as s,I as r,J as d,c as n,v as l,f as o,F as i,j as y,n as u,e as m,a as c}from"./vue-vendor-Bt65BSdi.js";import{_ as b}from"./_plugin-vue_export-helper-BCo6x5W8.js";const g={class:"relative bg-gray-100 dark:bg-[#0a0a0a] rounded-md p-2 overflow-hidden"},h={class:"grid grid-cols-15 gap-px",style:{"grid-template-columns":"repeat(15, minmax(0, 1fr))"}},p={class:"absolute inset-0 pointer-events-none"},v={class:"w-full h-full flex items-center justify-center"},x={class:"absolute inset-0 pointer-events-none"},f=b(a({__name:"SnakeReplay",props:{data:{}},setup(a){const b=a,f=a=>({x:Math.floor(a.x/2),y:Math.floor(a.y/2)}),k=e(()=>f(b.data.position)),w=t({head:f(b.data.snakeBody[0]||{x:0,y:0}),body:b.data.snakeBody.slice(1).map(f),dir:{...b.data.direction}}),M=e(()=>w.head),F=e(()=>w.body),_=e(()=>w.dir),A=a=>{const e=a%15,t=Math.floor(a/15);return e===k.value.x&&t===k.value.y?b.data.wasCorrect?"bg-emerald-300/70 dark:bg-emerald-700/60":"bg-red-300/70 dark:bg-red-700/60":"bg-gray-200 dark:bg-dark-bg-soft hover:bg-gray-300 dark:hover:bg-dark-bg-soft"},B=a=>({left:8+9*a.x+"px",top:8+9*a.y+"px"}),j=(a,e)=>({position:"absolute",zIndex:5,opacity:Math.max(.35,1-.1*e),transition:"left 120ms linear, top 120ms linear, opacity 300ms ease",...B(a)}),I=a=>({position:"absolute",...B(a)}),q=a=>{let e="translate(-50%, -50%)";return 1===a.x?e+=" translateX(25%)":-1===a.x?e+=" translateX(-25%)":1===a.y?e+=" translateY(25%)":-1===a.y&&(e+=" translateY(-25%)"),{position:"absolute",left:"50%",top:"50%",transform:e}};let C=null,z=0;let X=0;const Y=()=>{const a=performance.now();if(a-z<140)return void(C=requestAnimationFrame(Y));z=a;if(b.data.timelineFrames&&b.data.timelineFrames.length>0){const a=b.data.timelineFrames,e=a[X%a.length],t=e.body[0]||{x:0,y:0};w.head=f(t),w.body=e.body.slice(1).map(f),w.dir={x:e.direction.x,y:e.direction.y},X=(X+1)%a.length}else{const a=k.value,t=a.x-w.head.x,s=a.y-w.head.y,r={x:Math.sign(t),y:Math.sign(s)},d=Math.abs(t)>=Math.abs(s)?{x:r.x,y:0}:{x:0,y:r.y},n=[{...w.head},...w.body.slice(0,Math.max(0,w.body.length-0))];w.body=n.slice(0,b.data.snakeBody.length-1);const l={x:w.head.x+d.x,y:w.head.y+d.y};w.dir=d,(e=l).x>=0&&e.y>=0&&e.x<15&&e.y<10&&(w.head=l),J.value++;(w.head.x===a.x&&w.head.y===a.y||J.value>=18)&&(w.head=f(b.data.snakeBody[0]||{x:0,y:0}),w.body=b.data.snakeBody.slice(1).map(f),w.dir={...b.data.direction},J.value=0)}var e;C=requestAnimationFrame(Y)},J=s(0);return r(()=>{z=performance.now(),C=requestAnimationFrame(Y)}),d(()=>{C&&cancelAnimationFrame(C)}),(a,e)=>{return l(),n("div",g,[o("div",h,[(l(),n(i,null,y(150,a=>o("div",{key:a,class:u(["w-2 h-2 transition-colors duration-300",A(a-1)])},null,2)),64))]),o("div",p,[(l(!0),n(i,null,y(F.value,(a,e)=>(l(),n("div",{key:`seg-${e}`,class:"w-2 h-2 rounded-sm bg-green-300 dark:bg-green-600",style:c(j(a,e))},null,4))),128)),M.value?(l(),n("div",{key:0,class:"w-3 h-3 rounded-full bg-green-500 border border-green-300 animate-pulse",style:c((t=M.value,{position:"absolute",zIndex:10,...B(t)}))},[o("div",v,[o("div",{class:"w-1 h-1 bg-white rounded-full",style:c(q(_.value))},null,4)])],4)):m("",!0)]),o("div",x,[o("div",{class:u(["w-3 h-3 rounded-full animate-ping",a.data.wasCorrect?"bg-emerald-400 dark:bg-emerald-500":"bg-red-400 dark:bg-red-500"]),style:c(I(k.value))},null,6)])]);var t}}}),[["__scopeId","data-v-b407b167"]]);export{f as default};
