import{d as e,A as t,C as r,D as a,c as n,v as s,f as l,e as o,t as i,F as d,j as c,M as u,_ as x,n as b}from"./vue-vendor-Bt65BSdi.js";import{u as g}from"./ui-vendor-D-J_fEQ5.js";import{u as p}from"./voiceStore-o6lhlGgY.js";const k={class:"bg-white dark:bg-[#0a0a0a] rounded-xl shadow-lg border border-gray-200 dark:border-white/10 p-6"},m={class:"mb-6"},v={class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},w={class:"bg-gray-50 dark:bg-[#0a0a0a]/50 rounded-lg p-4 mb-4"},y={class:"text-lg leading-relaxed text-gray-900 dark:text-white"},h={key:0},f=["onUpdate:modelValue","placeholder","disabled"],q={key:0,class:"mb-4"},A={class:"text-sm font-medium text-gray-700 dark:text-white/80 mb-2"},C={class:"flex flex-wrap gap-2"},B=["onClick","disabled"],M={key:1,class:"mb-4"},_={key:0,class:"mb-6 space-y-4"},j={class:"p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg"},L={class:"font-medium text-green-800 dark:text-green-200 mb-2"},I={class:"text-lg leading-relaxed text-green-700 dark:text-green-300"},V={key:0},E={key:1,class:"inline-block mx-1 px-2 py-1 bg-green-100 dark:bg-green-800 rounded border font-medium"},F={key:0,class:"p-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-lg"},H={class:"font-medium text-red-800 dark:text-red-200 mb-2"},Q={class:"text-lg leading-relaxed text-red-700 dark:text-red-300"},$={key:0},z={key:1,class:"mb-6 p-4 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700 rounded-lg"},U={class:"font-medium text-yellow-800 dark:text-yellow-200 mb-2"},D={class:"text-yellow-700 dark:text-yellow-300 text-sm"},J={class:"flex justify-between items-center"},N={class:"flex items-center space-x-4"},P={key:1,class:"text-sm text-blue-600 dark:text-blue-400"},S={class:"flex space-x-4"},W=["disabled"],Y=e({__name:"FillBlankExercise",props:{question:{},questionIndex:{},totalQuestions:{}},emits:["answer","next","complete"],setup(e,{emit:Y}){const{t:G}=g(),K=(e,t,r)=>{try{const a=G(e,r);return"string"==typeof a&&a!==e?a:t}catch{return t}},{playAudio:O}=p(),R=e,T=Y,X=t([]),Z=t(!1),ee=t(!1),te=t(null),re=r(()=>{if(!R.question?.sentence)return[];const e=[],t=/___+/g;let r,a=0,n=0;for(;null!==(r=t.exec(R.question.sentence));)r.index>a&&e.push({type:"text",content:R.question.sentence.slice(a,r.index)}),e.push({type:"blank",index:n++}),a=t.lastIndex;return a<R.question.sentence.length&&e.push({type:"text",content:R.question.sentence.slice(a)}),e}),ae=r(()=>!!R.question?.correctAnswers&&(X.value.length===R.question.correctAnswers.length&&X.value.every(e=>e&&""!==e.trim()))),ne=r(()=>!!R.question?.correctAnswers&&X.value.some((e,t)=>e.toLowerCase().trim()!==R.question.correctAnswers[t].toLowerCase().trim())),se=r(()=>R.question?.correctAnswers?X.value.filter((e,t)=>e.toLowerCase().trim()===R.question.correctAnswers[t].toLowerCase().trim()).length:0),le=e=>"blank"===e.type,oe=e=>!!(Z.value&&X.value[e]&&R.question?.correctAnswers?.[e])&&X.value[e].toLowerCase().trim()===R.question.correctAnswers[e].toLowerCase().trim(),ie=()=>{X.value=[]},de=()=>{if(!ae.value||!R.question?.correctAnswers)return;Z.value=!0;const e=se.value===R.question.correctAnswers.length;T("answer",{isCorrect:e,userAnswer:[...X.value],correctAnswer:[...R.question.correctAnswers]})},ce=()=>{R.questionIndex===R.totalQuestions-1?T("complete"):(X.value=[],Z.value=!1,ee.value=!1,te.value=null,T("next"))},ue=async()=>{try{let e=R.question.sentence;R.question.correctAnswers.forEach((t,r)=>{e=e.replace(/___+/,t)}),await O(e)}catch(e){console.error("Error playing audio:",e)}};return a(()=>R.question,e=>{e&&e.correctAnswers&&e.correctAnswers.length>0&&(X.value=new Array(e.correctAnswers.length).fill(""))},{immediate:!0}),(e,t)=>(s(),n("div",k,[l("div",m,[l("h3",v,i(K("grammar.practice.fillBlank.instruction","Fill in the blanks")),1),l("div",w,[l("div",y,[(s(!0),n(d,null,c(re.value,(e,t)=>(s(),n("span",{key:t},["text"===e.type?(s(),n("span",h,i(e.content),1)):"blank"===e.type?u((s(),n("input",{key:1,"onUpdate:modelValue":t=>X.value[e.index]=t,class:b(["inline-block mx-1 px-3 py-1 border-b-2 bg-transparent text-center min-w-20 focus:outline-none transition-colors",Z.value?oe(e.index)?"border-green-500 text-green-600 dark:text-green-400":"border-red-500 text-red-600 dark:text-red-400":"border-blue-500 focus:border-blue-600"]),placeholder:`(${e.index+1})`,disabled:Z.value},null,10,f)),[[x,X.value[e.index]]]):o("",!0)]))),128))])]),e.question.wordBank&&e.question.wordBank.length>0?(s(),n("div",q,[l("h4",A,i(K("grammar.practice.fillBlank.wordBank","Word bank")),1),l("div",C,[(s(!0),n(d,null,c(e.question.wordBank,e=>(s(),n("button",{key:e,onClick:t=>(e=>{if(null!==te.value)X.value[te.value]=e;else{const t=X.value.findIndex(e=>!e||""===e.trim());-1!==t&&(X.value[t]=e)}})(e),disabled:Z.value,class:"px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},i(e),9,B))),128))])])):o("",!0),e.question.audio?(s(),n("div",M,[l("button",{onClick:ue,class:"flex items-center space-x-2 px-4 py-2 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors"},[t[1]||(t[1]=l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m-2.036-5.036a2.5 2.5 0 010 3.536M6 10h4l4.5-4.5v9L10 10H6V8z"})],-1)),l("span",null,i(K("grammar.practice.playAudio","Play audio")),1)])])):o("",!0)]),Z.value?(s(),n("div",_,[l("div",j,[l("h4",L,i(K("grammar.practice.correctAnswers","Correct answers")),1),l("div",I,[(s(!0),n(d,null,c(re.value,(t,r)=>(s(),n("span",{key:`correct-${r}`},["text"===t.type?(s(),n("span",V,i(t.content),1)):"blank"===t.type?(s(),n("span",E,i(e.question.correctAnswers[t.index]),1)):o("",!0)]))),128))])]),ne.value?(s(),n("div",F,[l("h4",H,i(K("grammar.practice.yourAnswers","Your answers")),1),l("div",Q,[(s(!0),n(d,null,c(re.value,(e,t)=>(s(),n("span",{key:`user-${t}`},["text"===e.type?(s(),n("span",$,i(e.content),1)):le(e)?(s(),n("span",{key:1,class:b(["inline-block mx-1 px-2 py-1 rounded border font-medium",oe(e.index)?"bg-green-100 dark:bg-green-800 text-green-700 dark:text-green-300":"bg-red-100 dark:bg-red-800 text-red-700 dark:text-red-300"])},i(X.value[e.index]||"(empty)"),3)):o("",!0)]))),128))])])):o("",!0)])):o("",!0),Z.value&&e.question.explanation?(s(),n("div",z,[l("h4",U,i(K("grammar.practice.explanation","Explanation")),1),l("p",D,i(e.question.explanation),1)])):o("",!0),l("div",J,[l("div",N,[!Z.value&&e.question.hint?(s(),n("button",{key:0,onClick:t[0]||(t[0]=e=>ee.value=!ee.value),class:"flex items-center space-x-2 px-4 py-2 text-sm text-gray-600 dark:text-white/60 hover:text-gray-800 dark:hover:text-white transition-colors"},[t[2]||(t[2]=l("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})],-1)),l("span",null,i(K("grammar.practice.hint","Hint")),1)])):o("",!0),ee.value&&e.question.hint?(s(),n("div",P," ðŸ’¡ "+i(e.question.hint),1)):o("",!0),Z.value?o("",!0):(s(),n("button",{key:2,onClick:ie,class:"flex items-center space-x-2 px-4 py-2 text-sm text-gray-600 dark:text-white/60 hover:text-gray-800 dark:hover:text-white transition-colors"},[t[3]||(t[3]=l("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),l("span",null,i(K("grammar.practice.clear","Clear")),1)]))]),l("div",S,[Z.value?(s(),n("button",{key:1,onClick:ce,class:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},i(e.questionIndex===e.totalQuestions-1?K("grammar.practice.finish","Finish"):K("grammar.practice.next","Next")),1)):(s(),n("button",{key:0,onClick:de,disabled:!ae.value,class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 dark:disabled:bg-white/20 disabled:cursor-not-allowed transition-colors"},i(K("grammar.practice.checkAnswer","Check answer")),9,W))])])]))}});export{Y as default};
