const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["/web-english/assets/QuizHeader-KMeKCKGW.js","/web-english/assets/vue-vendor-Bt65BSdi.js","/web-english/assets/QuizProgress-D3TlrKKr.js","/web-english/assets/ui-vendor-D-J_fEQ5.js","/web-english/assets/QuizSetup-Cdv4RwiV.js","/web-english/assets/QuizQuestion-BNytIkjs.js","/web-english/assets/QuizResults-BZY2K_VX.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-DmJNupMF.js";import{d as l,V as a,A as t,C as u,I as s,D as n,J as o,c as r,v as i,y as v,f as c,u as m,N as g,b as p}from"./vue-vendor-Bt65BSdi.js";import{l as d}from"./import-helper-Bho6F3X4.js";import{u as h}from"./useVocabularyStore-CJz0zgKu.js";import"./ui-vendor-D-J_fEQ5.js";const _={class:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-100 dark:from-gray-900 dark:to-[#0a0a0a]"},q={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},f=l({__name:"QuizView",setup(l){const f=g(d(()=>e(()=>import("./QuizHeader-KMeKCKGW.js"),__vite__mapDeps([0,1]),import.meta.url))),y=g(d(()=>e(()=>import("./QuizProgress-D3TlrKKr.js"),__vite__mapDeps([2,3,1]),import.meta.url))),w=g(d(()=>e(()=>import("./QuizSetup-Cdv4RwiV.js"),__vite__mapDeps([4,1,3]),import.meta.url))),b=g(d(()=>e(()=>import("./QuizQuestion-BNytIkjs.js"),__vite__mapDeps([5,3,1]),import.meta.url))),k=g(d(()=>e(()=>import("./QuizResults-BZY2K_VX.js"),__vite__mapDeps([6,3,1]),import.meta.url))),x=a(),I=h(),Q=t(!1),V=t(!1),z=t(0),j=t(null),A=t([]),E=t(0),L=t(0);let R=null;const P=t({type:"vocabulary",level:"",questionCount:"10",timeLimit:"10"}),S=t([]),D=()=>{const e=I.allVocabularies.value;console.log("Updating questions from",e.length,"total vocabularies");const l=e.filter(e=>!P.value.level||e.level===P.value.level);console.log("Filtered to",l.length,"vocabularies for quiz");const a=(e=>(console.log("Generating questions from",e.length,"vocabularies"),0===e.length?[]:e.map((l,a)=>{const t=e.filter(e=>e.id!==l.id);let u=[];t.length>0&&(u=t.slice(0,3).map(e=>e.meaning.split(" - ")[0]));const s=["Không có nghĩa","Từ khác","Khái niệm khác","Nghĩa khác","Ý nghĩa khác"];for(;u.length<3;){const e=s[Math.floor(Math.random()*s.length)];u.includes(e)||u.push(e)}const n=l.meaning.split(" - ")[0],o=[n,...u.slice(0,3)].sort(()=>Math.random()-.5),r=o.indexOf(n);return{id:l.id,type:"vocabulary",level:l.level,question:`What does "${l.word}" mean?`,options:o,correctAnswer:r,explanation:`"${l.word}" có nghĩa là: ${l.meaning}`}}).sort(()=>Math.random()-.5)))(l),t=parseInt(P.value.questionCount);S.value=a.slice(0,t),console.log("Generated",S.value.length,"questions")},O=u(()=>I.getLevels.value),T=u(()=>S.value[z.value]||{}),M=u(()=>(z.value+1)/S.value.length*100),G=u(()=>A.value.filter((e,l)=>e===S.value[l].correctAnswer).length),C=u(()=>G.value/S.value.length*100),K=e=>{e&&(P.value={...e}),0===S.value.length&&D(),0!==S.value.length?(Q.value=!0,"0"!==P.value.timeLimit&&(L.value=60*parseInt(P.value.timeLimit),N()),A.value=new Array(S.value.length).fill(-1)):alert("Không có từ vựng nào để luyện tập. Vui lòng thêm từ vựng trước!")},N=()=>{R=setInterval(()=>{L.value--,L.value<=0&&H()},1e3)},$=e=>{j.value=e},B=()=>{null!==j.value&&(A.value[z.value]=j.value,z.value===S.value.length-1?H():(z.value++,j.value=-1!==A.value[z.value]?A.value[z.value]:null))},F=()=>{z.value>0&&(A.value[z.value]=j.value||-1,z.value--,j.value=-1!==A.value[z.value]?A.value[z.value]:null)},H=()=>{null!==j.value&&(A.value[z.value]=j.value),E.value=10*G.value,V.value=!0,R&&clearInterval(R)},J=()=>{Q.value=!1,V.value=!1,z.value=0,j.value=null,A.value=[],E.value=0,L.value=0,D(),R&&clearInterval(R)},U=()=>{x.back()};return s(async()=>{const e=I.initializeStore();e.value||await new Promise(l=>n(e,e=>{e&&l(!0)},{immediate:!0})),D(),console.log("Quiz view mounted",I.allVocabularies.value.length,"vocabularies loaded")}),n(()=>I.isStoreReady.value,e=>{e&&D()},{immediate:!0}),n(()=>I.allVocabularies.value,()=>{I.isStoreReady.value&&D()},{deep:!0}),n(()=>P.value,()=>{D()},{deep:!0}),o(()=>{R&&clearInterval(R)}),(e,l)=>(i(),r("div",_,[v(m(f),{"time-remaining":L.value,score:E.value,onGoBack:U},null,8,["time-remaining","score"]),v(m(y),{"current-question-index":z.value,"total-questions":S.value.length,"progress-percentage":M.value},null,8,["current-question-index","total-questions","progress-percentage"]),c("div",q,[Q.value?V.value?(i(),p(m(k),{key:2,score:E.value,"correct-answers":G.value,"total-questions":S.value.length,accuracy:Math.round(C.value),questions:S.value,"user-answers":A.value,onRestartQuiz:J,onGoBack:U},null,8,["score","correct-answers","total-questions","accuracy","questions","user-answers"])):(i(),p(m(b),{key:1,question:T.value,"selected-answer":j.value,"is-first-question":0===z.value,"is-last-question":z.value===S.value.length-1,onSelectAnswer:$,onPreviousQuestion:F,onNextQuestion:B},null,8,["question","selected-answer","is-first-question","is-last-question"])):(i(),p(m(w),{key:0,settings:P.value,"available-levels":O.value,onStartQuiz:K},null,8,["settings","available-levels"]))])]))}});export{f as default};
