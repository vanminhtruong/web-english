import{d as e,A as r,C as a,I as t,J as s,c as l,v as o,f as n,e as i,t as d,F as u,j as c,n as g,M as b,a6 as v,_ as p,g as x}from"./vue-vendor-Bt65BSdi.js";import{u as k}from"./ui-vendor-D-J_fEQ5.js";import{u as m}from"./voiceStore-o6lhlGgY.js";const h={class:"bg-white dark:bg-[#0a0a0a] rounded-xl shadow-lg border border-gray-200 dark:border-white/10 p-6"},y={class:"mb-8"},w={class:"flex items-center justify-between mb-4"},f={class:"text-lg font-semibold text-gray-900 dark:text-white"},q={class:"flex items-center space-x-4"},A={class:"text-sm text-gray-500 dark:text-white/60"},C={class:"bg-gray-50 dark:bg-[#0a0a0a]/50 rounded-lg p-6 max-h-96 overflow-y-auto"},M={class:"prose dark:prose-invert max-w-none"},j=["innerHTML"],L={class:"space-y-6"},I={class:"text-lg font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-white/10 pb-2"},V={class:"space-y-6"},H={class:"mb-4"},U={class:"font-medium text-gray-900 dark:text-white mb-2"},$={key:0,class:"space-y-2"},B=["name","value","onUpdate:modelValue","disabled"],E={class:"text-gray-900 dark:text-white"},Q={class:"ml-auto"},R={key:0,class:"w-5 h-5 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},S={key:1,class:"w-5 h-5 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},T={key:1,class:"space-y-2"},F=["name","value","onUpdate:modelValue","disabled"],_={class:"text-gray-900 dark:text-white"},z={key:2,class:"space-y-2"},J=["onUpdate:modelValue","disabled","placeholder"],N={key:0,class:"text-sm text-green-600 dark:text-green-400"},Y={key:0,class:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700 rounded-lg"},D={class:"text-sm text-yellow-800 dark:text-yellow-200"},G={key:0,class:"mt-8 p-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg"},K={class:"grid grid-cols-3 gap-4 text-center"},O={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},P={class:"text-sm text-gray-600 dark:text-white/60"},W={class:"text-2xl font-bold text-red-600 dark:text-red-400"},X={class:"text-sm text-gray-600 dark:text-white/60"},Z={class:"text-2xl font-bold text-green-600 dark:text-green-400"},ee={class:"text-sm text-gray-600 dark:text-white/60"},re={class:"flex justify-between items-center mt-8"},ae={class:"flex space-x-4"},te={class:"flex items-center space-x-2 text-sm text-gray-600 dark:text-white/60"},se={class:"flex space-x-4"},le=["disabled"],oe=e({__name:"ReadingExercise",props:{question:{},questionIndex:{},totalQuestions:{}},emits:["answer","next","complete"],setup(e,{emit:oe}){const{t:ne}=k(),ie=(e,r,a)=>{try{const t=ne(e,a);return"string"==typeof t&&t!==e?t:r}catch{return r}},{playAudio:de}=m(),ue=e,ce=oe,ge=r([]),be=r(!1),ve=r(!1),pe=r(0),xe=r(null),ke=a(()=>{let e=ue.question.passage;return ve.value&&ue.question.keywords&&ue.question.keywords.forEach(r=>{const a=new RegExp(`\\b${r}\\b`,"gi");e=e.replace(a,`<mark class="bg-yellow-200 dark:bg-yellow-700 px-1 rounded">${r}</mark>`)}),e}),me=a(()=>!!ue.question?.questions&&(ge.value.length===ue.question.questions.length&&ge.value.every(e=>null!=e&&""!==e))),he=a(()=>ue.question?.questions?ue.question.questions.filter((e,r)=>"short-answer"===e.type?fe(r):ge.value[r]===e.correctAnswer).length:0),ye=a(()=>ue.question?.questions?ue.question.questions.length-he.value:0),we=a(()=>ue.question.questions.length>0?Math.round(he.value/ue.question.questions.length*100):0),fe=e=>{const r=ge.value[e],a=ue.question.questions[e].correctAnswer;return!(!r||!a)&&r.toLowerCase().trim()===a.toLowerCase().trim()},qe=()=>{ve.value=!ve.value},Ae=()=>{if(!me.value)return;be.value=!0,Ie();const e=he.value===ue.question.questions.length;ce("answer",{isCorrect:e,correctAnswers:he.value,totalQuestions:ue.question.questions.length})},Ce=()=>{ue.questionIndex===ue.totalQuestions-1?ce("complete"):(je(),ce("next"))},Me=async()=>{try{await de(ue.question.passage)}catch(e){console.error("Error playing passage audio:",e)}},je=()=>{ge.value=[],be.value=!1,ve.value=!1,pe.value=0,Le()},Le=()=>{xe.value=setInterval(()=>{pe.value+=1},1e3)},Ie=()=>{xe.value&&(clearInterval(xe.value),xe.value=null)},Ve=e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`;return t(()=>{ue.question?.questions&&Array.isArray(ue.question.questions)?ge.value=new Array(ue.question.questions.length).fill(null):ge.value=[],Le()}),s(()=>{Ie()}),(e,r)=>(o(),l("div",h,[n("div",y,[n("div",w,[n("h3",f,d(e.question.title||ie("grammar.practice.reading.passage","Reading passage")),1),n("div",q,[e.question.audio?(o(),l("button",{key:0,onClick:Me,class:"flex items-center space-x-2 px-3 py-2 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-colors"},[r[0]||(r[0]=n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.536 8.464a5 5 0 010 7.072m-2.036-5.036a2.5 2.5 0 010 3.536M6 10h4l4.5-4.5v9L10 10H6V8z"})],-1)),n("span",null,d(ie("grammar.practice.reading.listen","Listen")),1)])):i("",!0),n("div",A,d(ie("grammar.practice.reading.readingTime","Reading time"))+": "+d(Ve(pe.value)),1)])]),n("div",C,[n("div",M,[n("div",{innerHTML:ke.value,class:"text-gray-800 dark:text-gray-200 leading-relaxed text-justify"},null,8,j)])])]),n("div",L,[n("h4",I,d(ie("grammar.practice.reading.questions","Questions")),1),n("div",V,[(o(!0),l(u,null,c(e.question.questions,(e,a)=>(o(),l("div",{key:a,class:"border border-gray-200 dark:border-white/10 rounded-lg p-4"},[n("div",H,[n("h5",U,d(a+1)+". "+d(e.question),1),"multiple-choice"===e.type?(o(),l("div",$,[(o(!0),l(u,null,c(e.options,(t,s)=>(o(),l("label",{key:s,class:g(["flex items-start space-x-3 p-3 rounded-lg cursor-pointer transition-all",ge.value[a]===s?"bg-blue-50 dark:bg-blue-900/30 border border-blue-300 dark:border-blue-600":"bg-gray-50 dark:bg-[#0a0a0a]/50 hover:bg-gray-100 dark:hover:bg-[#0a0a0a]/70 border border-transparent",be.value&&s===e.correctAnswer?"bg-green-50 dark:bg-green-900/30 border border-green-300 dark:border-green-600":"",be.value&&ge.value[a]===s&&s!==e.correctAnswer?"bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-600":""])},[b(n("input",{type:"radio",name:`question-${a}`,value:s,"onUpdate:modelValue":e=>ge.value[a]=e,disabled:be.value,class:"mt-1"},null,8,B),[[v,ge.value[a]]]),n("span",E,d(t),1),n("div",Q,[be.value&&s===e.correctAnswer?(o(),l("svg",R,r[1]||(r[1]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):be.value&&ge.value[a]===s&&s!==e.correctAnswer?(o(),l("svg",S,r[2]||(r[2]=[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):i("",!0)])],2))),128))])):"true-false"===e.type?(o(),l("div",T,[(o(),l(u,null,c(["true","false"],r=>n("label",{key:r,class:g(["flex items-center space-x-3 p-3 rounded-lg cursor-pointer transition-all",ge.value[a]===r?"bg-blue-50 dark:bg-blue-900/30 border border-blue-300 dark:border-blue-600":"bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700 border border-transparent",be.value&&r===e.correctAnswer?"bg-green-50 dark:bg-green-900/30 border border-green-300 dark:border-green-600":"",be.value&&ge.value[a]===r&&r!==e.correctAnswer?"bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-600":""])},[b(n("input",{type:"radio",name:`question-${a}`,value:r,"onUpdate:modelValue":e=>ge.value[a]=e,disabled:be.value},null,8,F),[[v,ge.value[a]]]),n("span",_,d("true"===r?ie("grammar.practice.reading.true","True"):ie("grammar.practice.reading.false","False")),1)],2)),64))])):"short-answer"===e.type?(o(),l("div",z,[b(n("input",{"onUpdate:modelValue":e=>ge.value[a]=e,disabled:be.value,placeholder:ie("grammar.practice.reading.yourAnswer","Your answer"),class:g(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",be.value?fe(a)?"border-green-500 bg-green-50 dark:bg-green-900/30":"border-red-500 bg-red-50 dark:bg-red-900/30":"border-gray-300 dark:border-white/10 bg-white dark:bg-[#0a0a0a]","text-gray-900 dark:text-white"])},null,10,J),[[p,ge.value[a]]]),be.value&&!fe(a)?(o(),l("div",N,d(ie("grammar.practice.reading.correctAnswer","Correct answer"))+": "+d(e.correctAnswer),1)):i("",!0)])):i("",!0)]),be.value&&e.explanation?(o(),l("div",Y,[n("p",D,[n("strong",null,d(ie("grammar.practice.explanation","Explanation"))+":",1),x(" "+d(e.explanation),1)])])):i("",!0)]))),128))])]),be.value?(o(),l("div",G,[n("div",K,[n("div",null,[n("div",O,d(he.value),1),n("div",P,d(ie("grammar.practice.reading.correct","Correct")),1)]),n("div",null,[n("div",W,d(ye.value),1),n("div",X,d(ie("grammar.practice.reading.incorrect","Incorrect")),1)]),n("div",null,[n("div",Z,d(we.value)+"%",1),n("div",ee,d(ie("grammar.practice.reading.accuracy","Accuracy")),1)])])])):i("",!0),n("div",re,[n("div",ae,[n("button",{onClick:qe,class:"flex items-center space-x-2 px-4 py-2 text-sm text-gray-600 dark:text-white/60 hover:text-gray-800 dark:hover:text-white transition-colors"},[r[3]||(r[3]=n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14"})],-1)),n("span",null,d(ve.value?ie("grammar.practice.reading.hideHighlights","Hide highlights"):ie("grammar.practice.reading.showHighlights","Show highlights")),1)]),n("div",te,[r[4]||(r[4]=n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),n("span",null,d(Ve(pe.value)),1)])]),n("div",se,[be.value?(o(),l("button",{key:1,onClick:Ce,class:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},d(e.questionIndex===e.totalQuestions-1?ie("grammar.practice.finish","Finish"):ie("grammar.practice.next","Next")),1)):(o(),l("button",{key:0,onClick:Ae,disabled:!me.value,class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"},d(ie("grammar.practice.checkAnswer","Check answer")),9,le))])])]))}});export{oe as default};
