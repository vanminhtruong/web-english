const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["/web-english/assets/FireworkSoundEffect-DS0v3Px0.js","/web-english/assets/utils-vendor-DwIcHP6x.js","/web-english/assets/vue-vendor-Bt65BSdi.js","/web-english/assets/_plugin-vue_export-helper-BCo6x5W8.js","/web-english/assets/FireworkSoundEffect-CV0ieEWB.css"])))=>i.map(i=>d[i]);
import{_ as e}from"./index-DmJNupMF.js";import{d as t,A as r,C as a,D as o,I as n,a2 as s,c as l,v as i,f as c,e as d,y as u,t as p,u as f,i as v,n as m,F as g,j as h,M as x,_ as y,g as k,N as b,q as w}from"./vue-vendor-Bt65BSdi.js";import{u as C}from"./ui-vendor-D-J_fEQ5.js";import{u as D}from"./voiceStore-o6lhlGgY.js";import{_ as j}from"./_plugin-vue_export-helper-BCo6x5W8.js";const A={class:"h-full flex flex-col overflow-hidden"},L={class:"mb-4 flex items-center justify-center gap-3"},E={class:"px-3 py-1 bg-purple-100 dark:bg-dark-bg-mute text-purple-800 dark:text-purple-300 text-sm font-medium rounded-full"},M={class:"flex items-center gap-2"},_={class:"text-xs text-gray-600 dark:text-white/70"},B=["aria-pressed","title"],z={class:"flex-1 flex items-center justify-center mb-4 min-h-0"},T={key:0,class:"flex items-center justify-center bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-teal-900/30 dark:to-cyan-900/30 rounded-xl p-6 w-full max-w-lg border border-teal-200 dark:border-teal-700/50 shadow-sm"},I={class:"text-center space-y-3"},S={class:"max-h-32 overflow-y-auto"},N={class:"text-lg font-medium text-gray-900 dark:text-white leading-relaxed"},U={class:"text-sm text-teal-600 dark:text-teal-400 font-medium"},F={key:0,class:"relative"},P=["src","alt"],V={key:0,class:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-dark-bg-mute rounded-lg"},$={class:"text-center"},H={class:"text-sm text-gray-500 dark:text-white/60 mt-2"},Z={key:1,class:"flex items-center justify-center bg-gray-100 dark:bg-dark-bg-mute rounded-lg p-8 w-full max-w-sm"},K={class:"text-center"},R={class:"text-sm text-gray-500 dark:text-white/60 mt-2"},W={class:"flex-shrink-0"},G={class:"flex flex-wrap gap-2 justify-center items-center"},J={key:0,class:"px-1 text-lg text-gray-700 dark:text-white/80 select-none"},O=["onClick","onDragover","onDrop"],q={key:0,class:"uppercase tracking-wider"},Q={key:1,class:"caret-block","aria-hidden":"true"},X={key:2,class:"uppercase tracking-wider"},Y={key:0,class:"mt-3"},ee={class:"mb-2 flex justify-center"},te={class:"relative w-48 sm:w-56"},re=["placeholder"],ae=["aria-label","title"],oe={class:"flex flex-wrap gap-2 justify-center"},ne=["onDragstart"],se={key:0,class:"text-center space-y-2 max-h-32 overflow-y-auto mt-3"},le={key:0,class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},ie={key:1,class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},ce={key:0,class:"text-center"},de={class:"text-sm text-gray-600 dark:text-white/70"},ue={class:"font-semibold text-gray-900 dark:text-white"},pe={class:"text-xs text-gray-500 dark:text-white/60 mt-1 line-clamp-2"},fe={key:1,class:"text-center"},ve={class:"text-sm text-gray-600 dark:text-white/70 line-clamp-2"},me={key:1,class:"text-center text-sm text-gray-500 dark:text-white/60 mt-3"},ge=j(t({__name:"PictionaryMode",props:{card:{},pictionaryAnswer:{},pictionaryAnswered:{type:Boolean},pictionaryCorrect:{type:Boolean},definitionMode:{type:Boolean},getTopicName:{type:Function}},emits:["update:pictionary-answer","check-answer","pictionary-snapshot"],setup(t,{emit:j}){const ge=t,he=j,{t:xe}=C(),{playAudio:ye}=D(),ke=r(!1),be=r(null),we=r(!1),Ce=r(!1),De=r(!1),je=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZ"),Ae=r(""),Le=a(()=>{const e=Ae.value.trim().toUpperCase();if(!e)return je;const t=e.replace(/[^A-Z]/g,"");if(!t)return je;const r=new Set(t.split(""));return je.filter(e=>r.has(e))}),Ee=()=>{Ae.value=""},Me=b(()=>e(()=>import("./FireworkSoundEffect-DS0v3Px0.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)),_e=r(!1),Be=r(!1),ze=r(!1),Te=r(),Ie=r([]),Se=e=>{const t=e.normalize("NFKC");const r=[],a=e=>/^[a-z]$/i.test(e),o=[];for(let i=0;i<t.length;i++){a(t[i])&&o.push(i)}const n=o.length,s=n<=3?1:2,l=new Set;for(;l.size<Math.min(s,n);){const e=o[Math.floor(Math.random()*n)];l.add(e)}for(let i=0;i<t.length;i++){const e=t[i];a(e)?l.has(i)?r.push({char:e.toUpperCase(),fixed:!0}):r.push({char:"",fixed:!1}):r.push({char:e,fixed:!0,separator:!0})}Ie.value=r,Ne()},Ne=()=>{const e=Ie.value.map(e=>e.separator?e.char:e.char||"").join("");he("update:pictionary-answer",e)},Ue=()=>{const e=Ie.value.map(e=>({char:e.char,fixed:e.fixed,separator:e.separator}));he("pictionary-snapshot",{slots:e})},Fe=async()=>{await w();try{be.value?.focus({preventScroll:!0})}catch{be.value?.focus()}we.value=!0},Pe=()=>{ge.pictionaryAnswered||De.value||document.activeElement!==be.value&&Fe()},Ve=()=>{we.value=!1,Pe()},$e=()=>Ie.value.findIndex(e=>!e.fixed&&!e.char),He=()=>{for(let e=Ie.value.length-1;e>=0;e--){const t=Ie.value[e];if(!t.fixed&&t.char)return e}return-1},Ze=e=>e.replace(/[ưừứửữự]/g,"w").replace(/[ƯỪỨỬỮỰ]/g,"W").normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/đ/g,"d").replace(/Đ/g,"D"),Ke=e=>{if(ge.pictionaryAnswered)return;if(Ce.value)return;const t=e.key;if(De.value)return void("Enter"===t&&(Ue(),he("check-answer")));const r=Ze(t);if(/^[a-z]$/i.test(r)){const e=$e();return void(-1!==e&&(Ie.value[e].char=r.toUpperCase(),Ne()))}if("Backspace"===t){const e=He();-1!==e&&(Ie.value[e].char="",Ne())}else"Enter"===t&&(Ue(),he("check-answer"))},Re=e=>{if(ge.pictionaryAnswered)return;if(Ce.value)return;if(De.value)return void(be.value&&(be.value.value=""));const t=e,r=t.inputType;if("insertText"===r){const e=Ze(t.data||"");if(/^[a-z]$/i.test(e)){const t=$e();-1!==t&&(Ie.value[t].char=e.toUpperCase(),Ne())}}else if("deleteContentBackward"===r){const e=He();-1!==e&&(Ie.value[e].char="",Ne())}else"insertLineBreak"===r&&(Ue(),he("check-answer"));be.value&&(be.value.value="")},We=e=>{Ce.value||be.value&&(be.value.value="")},Ge=()=>{Ce.value=!0},Je=e=>{const t=(e.data||"").toString();Ze(t)},Oe=e=>{const t=(e.data||be.value?.value||"").toString(),r=Ze(t).toUpperCase();for(const a of r){if(!/^[A-Z]$/.test(a))continue;const e=$e();if(-1===e)break;Ie.value[e].char=a}Ne(),be.value&&(be.value.value=""),Ce.value=!1},qe=()=>{De.value&&!ge.pictionaryAnswered&&Ie.value.every(e=>e.fixed||e.separator||!!e.char)&&(Ue(),he("check-answer"))};o(()=>ge.card,e=>{ke.value=!1,e?.word&&Se(e.word),Pe()}),n(()=>{ge.card?.word&&Se(ge.card.word),Fe(),document.addEventListener("visibilitychange",Pe)}),s(()=>{document.removeEventListener("visibilitychange",Pe)});const Qe=()=>{ke.value=!0},Xe=()=>{_e.value=!1,Be.value=!1};o(()=>ge.pictionaryAnswered,e=>{e&&!_e.value&&(ze.value=ge.pictionaryCorrect,setTimeout(()=>{_e.value=!0,Be.value=!0},50)),e&&ge.pictionaryCorrect&&ge.card?.word&&Promise.resolve(ye(ge.card.word)).catch(()=>{}),e&&(we.value=!1),e||Pe()});const Ye=()=>{De.value=!De.value,De.value?we.value=!1:Fe()},et=e=>{const t=document.createElement("div");return t.textContent=e,t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.padding="6px 8px",t.style.fontWeight="700",t.style.fontSize="16px",t.style.borderRadius="8px",t.style.background="rgba(37,99,235,0.15)",t.style.color="#1D4ED8",t.style.border="1px solid rgba(37,99,235,0.35)",document.body.appendChild(t),setTimeout(()=>document.body.removeChild(t),0),t};return(e,t)=>(i(),l("div",{class:"bg-white dark:bg-black rounded-xl shadow-2xl border border-gray-200 dark:border-dark-bg-mute p-6 min-h-96 max-h-[560px] select-none",onCopy:t[3]||(t[3]=v(()=>{},["prevent"])),onCut:t[4]||(t[4]=v(()=>{},["prevent"])),onContextmenu:t[5]||(t[5]=v(()=>{},["prevent"])),onClick:Fe},[c("div",A,[c("div",L,[c("span",E,p(e.card?.category?e.getTopicName(e.card.category):""),1),c("div",M,[c("span",_,p(f(xe)("flashcard.pictionary.dragToggle","Drag & Drop")),1),c("button",{class:m(["relative inline-flex h-5 w-9 items-center rounded-full transition-colors border border-gray-300 dark:border-dark-bg-mute",De.value?"bg-blue-600":"bg-gray-200 dark:bg-dark-bg-soft"]),onClick:v(Ye,["stop"]),"aria-pressed":De.value?"true":"false",title:f(xe)("flashcard.pictionary.dragToggle","Drag & Drop")},[c("span",{class:m(["inline-block h-4 w-4 transform rounded-full bg-white transition-transform",De.value?"translate-x-5":"translate-x-1"])},null,2)],10,B)])]),c("div",z,[ge.definitionMode?(i(),l("div",T,[c("div",I,[t[6]||(t[6]=c("div",{class:"mx-auto w-12 h-12 bg-teal-100 dark:bg-teal-800/50 rounded-full flex items-center justify-center mb-4"},[c("svg",{class:"w-6 h-6 text-teal-600 dark:text-teal-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})])],-1)),c("div",S,[c("p",N,p(e.card?.meaning||f(xe)("flashcard.pictionary.noDefinition","No definition available")),1)]),c("p",U,p(f(xe)("flashcard.pictionary.definitionHint","Guess the word from this definition")),1)])])):(i(),l(g,{key:1},[e.card?.image?(i(),l("div",F,[c("img",{src:e.card.image,alt:f(xe)("flashcard.pictionary.imageAlt","Pictionary image"),class:"max-w-full max-h-40 object-contain rounded-lg shadow-md border border-gray-200 dark:border-dark-bg-mute",onError:Qe},null,40,P),ke.value?(i(),l("div",V,[c("div",$,[t[7]||(t[7]=c("svg",{class:"mx-auto h-12 w-12 text-gray-400 dark:text-white/50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 16m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),c("p",H,p(f(xe)("flashcard.image.imageError","Could not load image.")),1)])])):d("",!0)])):(i(),l("div",Z,[c("div",K,[t[8]||(t[8]=c("svg",{class:"mx-auto h-16 w-16 text-gray-400 dark:text-white/50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 16m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),c("p",R,p(f(xe)("flashcard.image.noImage","No image available for this card.")),1)])]))],64))]),c("div",W,[c("div",G,[(i(!0),l(g,null,h(Ie.value,(t,r)=>(i(),l("div",{key:r},[t.separator?(i(),l("div",J,p(t.char),1)):(i(),l("div",{key:1,class:m(["w-10 h-12 sm:w-12 sm:h-14 flex items-center justify-center rounded-md border text-xl sm:text-2xl font-semibold bg-white dark:bg-dark-bg-soft text-gray-900 dark:text-white border-gray-300 dark:border-dark-bg-mute transition-all duration-200",[t.fixed?"opacity-90":"cursor-pointer hover:bg-gray-50 dark:hover:bg-dark-bg-mute hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-sm",De.value&&!t.fixed?"ring-0":""]]),onClick:e=>(e=>{const t=Ie.value[e];!t||t.separator||t.fixed||(De.value?t.char&&(t.char="",Ne()):Fe())})(r),onDragover:v(e=>(e=>{const t=Ie.value[e];t&&!t.fixed&&t.separator})(r),["prevent"]),onDrop:v(e=>((e,t)=>{const r=Ie.value[e];if(!r||r.fixed||r.separator)return;const a=(t.dataTransfer?.getData("text/plain")||"").toUpperCase();/^[A-Z]$/.test(a)&&(r.char=a,Ne(),Ee(),qe())})(r,e),["prevent"])},[t.char?(i(),l("span",q,p(t.char),1)):De.value||!we.value||e.pictionaryAnswered||r!==$e()?(i(),l("span",X," ")):(i(),l("span",Q))],42,O))]))),128))]),De.value&&!e.pictionaryAnswered?(i(),l("div",Y,[c("div",ee,[c("div",te,[x(c("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>Ae.value=e),type:"text",inputmode:"text",autocomplete:"off",spellcheck:"false",placeholder:f(xe)("common.search","Search"),class:"w-full px-3 pr-8 py-1.5 text-sm rounded-md border bg-white text-gray-900 border-gray-300 dark:bg-dark-bg-soft dark:text-white dark:border-dark-bg-mute focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:t[1]||(t[1]=v(()=>{},["stop"]))},null,8,re),[[y,Ae.value]]),c("button",{type:"button",class:m(["absolute right-1.5 top-1/2 -translate-y-1/2 z-10 p-1 rounded text-gray-500 dark:text-white/70 hover:bg-gray-100 dark:hover:bg-white/10",{"opacity-40 pointer-events-none":!Ae.value}]),onClick:v(Ee,["stop"]),"aria-label":f(xe)("common.clear","Clear"),title:f(xe)("common.clear","Clear")},t[9]||(t[9]=[c("svg",{class:"w-4 h-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[c("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),10,ae)])]),c("div",oe,[(i(!0),l(g,null,h(Le.value,e=>(i(),l("button",{key:e,class:"w-8 h-10 sm:w-9 sm:h-11 inline-flex items-center justify-center rounded-md text-base sm:text-lg font-semibold border bg-blue-50 text-blue-700 border-blue-200 dark:bg-dark-bg-soft dark:text-blue-300 dark:border-blue-900/40 hover:shadow transition",draggable:"true",onDragstart:t=>((e,t)=>{t.dataTransfer?.setData("text/plain",e),t.dataTransfer?.setDragImage?.(et(e),12,12)})(e,t)},p(e),41,ne))),128))])])):d("",!0),c("input",{ref_key:"hiddenInput",ref:be,type:"text",class:"fixed top-0 left-0 w-px h-px opacity-0",tabindex:"-1","aria-hidden":"true",autocomplete:"off",autocapitalize:"off",spellcheck:"false",inputmode:"text",onBeforeinput:v(Re,["stop","prevent"]),onInput:v(We,["stop","prevent"]),onKeydown:v(Ke,["stop","prevent"]),onCompositionstart:Ge,onCompositionupdate:Je,onCompositionend:Oe,onFocus:t[2]||(t[2]=e=>we.value=!0),onBlur:Ve},null,544)]),e.pictionaryAnswered?(i(),l("div",se,[c("div",{class:m(["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",e.pictionaryCorrect?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300":"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300"])},[e.pictionaryCorrect?(i(),l("svg",le,t[10]||(t[10]=[c("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)]))):(i(),l("svg",ie,t[11]||(t[11]=[c("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 0 1 1.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 0 1 0-1.414z","clip-rule":"evenodd"},null,-1)]))),k(" "+p(e.pictionaryCorrect?f(xe)("common.correct","Correct"):f(xe)("common.incorrect","Incorrect")),1)],2),e.pictionaryCorrect?(i(),l("div",fe,[c("p",ve,p(e.card?.meaning),1)])):(i(),l("div",ce,[c("p",de,[k(p(f(xe)("flashcard.image.correctAnswer","Correct answer"))+": ",1),c("span",ue,p(e.card?.word),1)]),c("p",pe,p(e.card?.meaning),1)]))])):d("",!0),e.pictionaryAnswered?d("",!0):(i(),l("p",me,p(ge.definitionMode?De.value?f(xe)("flashcard.pictionary.dragInstructionDefinition","Look at the definition above, drag letters into the boxes, then press Enter to check."):f(xe)("flashcard.pictionary.instructionDefinition","Look at the definition above, click the boxes and type to fill in the missing letters. Press Enter to check."):De.value?f(xe)("flashcard.pictionary.dragInstruction","Drag letters into the boxes, then press Enter to check."):f(xe)("flashcard.pictionary.instruction","Click the boxes and type to fill in the missing letters. Press Enter to check.")),1)),u(f(Me),{ref_key:"fireworkEffect",ref:Te,"trigger-firework":_e.value,"trigger-sound":Be.value,"is-correct":ze.value,onEffectComplete:Xe},null,8,["trigger-firework","trigger-sound","is-correct"])])],32))}}),[["__scopeId","data-v-66235204"]]);export{ge as default};
